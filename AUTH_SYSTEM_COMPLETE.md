# âœ… èªè­‰ç³»çµ±å®Œæˆ

## ğŸ“¦ å·²å®Œæˆçš„åŠŸèƒ½

### 1. Auth Store (Zustand)
âœ… æª”æ¡ˆï¼š`src/store/authStore.ts`
- ç™»å…¥åŠŸèƒ½ï¼ˆå«ä½¿ç”¨æœŸé™æª¢æŸ¥ï¼‰
- ç™»å‡ºåŠŸèƒ½
- å¿˜è¨˜å¯†ç¢¼åŠŸèƒ½
- é‡è¨­å¯†ç¢¼åŠŸèƒ½
- è‡ªå‹•æª¢æŸ¥èªè­‰ç‹€æ…‹
- ç›£è½ auth ç‹€æ…‹è®ŠåŒ–

### 2. é é¢å…ƒä»¶
âœ… ç™»å…¥é é¢ï¼š`src/pages/LoginPage.tsx`
- Email/å¯†ç¢¼ç™»å…¥
- å¿˜è¨˜å¯†ç¢¼é€£çµ
- è‡ªå‹•å°å‘å·²ç™»å…¥ä½¿ç”¨è€…

âœ… å¿˜è¨˜å¯†ç¢¼é é¢ï¼š`src/pages/ForgotPasswordPage.tsx`
- è¼¸å…¥ email ç™¼é€é‡è¨­é€£çµ
- ä½¿ç”¨ Supabase å…§å»ºåŠŸèƒ½

âœ… é‡è¨­å¯†ç¢¼é é¢ï¼š`src/pages/ResetPasswordPage.tsx`
- é€é email é€£çµé‡è¨­å¯†ç¢¼
- å¯†ç¢¼é©—è­‰ï¼ˆ6 å­—å…ƒä»¥ä¸Šï¼‰
- è‡ªå‹•å°å‘ç™»å…¥é 

âœ… é‚€è«‹é é¢ï¼š`src/pages/InvitePage.tsx`
- æ–°ä½¿ç”¨è€…é€éé‚€è«‹é€£çµè¨­å®šå¯†ç¢¼
- Token é©—è­‰

### 3. è·¯ç”±ä¿è­·
âœ… å—ä¿è­·è·¯ç”±ï¼š`src/components/ProtectedRoute.tsx`
- æª¢æŸ¥ç™»å…¥ç‹€æ…‹
- æª¢æŸ¥å¸³è™Ÿå•Ÿç”¨ç‹€æ…‹
- æª¢æŸ¥ä½¿ç”¨æœŸé™ï¼ˆadmin ä¸å—é™åˆ¶ï¼‰
- é¡¯ç¤ºå°æ‡‰éŒ¯èª¤è¨Šæ¯

âœ… ç®¡ç†å“¡è·¯ç”±ï¼š`src/components/AdminRoute.tsx`
- åªå…è¨± admin è§’è‰²å­˜å–
- é admin è‡ªå‹•å°å‘å·¥ä½œå€

### 4. è·¯ç”±æ•´åˆ
âœ… App.tsx å®Œæ•´è·¯ç”±è¨­å®š
- å…¬é–‹è·¯ç”±ï¼ˆç™»å…¥ã€å¿˜è¨˜å¯†ç¢¼ã€é‡è¨­å¯†ç¢¼ã€é‚€è«‹ï¼‰
- å—ä¿è­·çš„ä½¿ç”¨è€…è·¯ç”±ï¼ˆå·¥ä½œå€ã€æ¨¡æ¿ã€æ­·å²ã€è¨­å®šï¼‰
- ç®¡ç†å“¡è·¯ç”±ï¼ˆå„€è¡¨æ¿ã€ä½¿ç”¨è€…ç®¡ç†ã€æ¨¡æ¿ç®¡ç†ï¼‰

---

## ğŸ”§ æ¸¬è©¦èªè­‰ç³»çµ±

### æ­¥é©Ÿ 1: åœ¨ Supabase å»ºç«‹æ¸¬è©¦ä½¿ç”¨è€…

1. å‰å¾€ Supabase Dashboard â†’ SQL Editor
2. åŸ·è¡Œä»¥ä¸‹ SQL å»ºç«‹æ¸¬è©¦ admin ä½¿ç”¨è€…ï¼š

```sql
-- æ–¹æ³•ä¸€ï¼šé€é Supabase Auth å»ºç«‹ä½¿ç”¨è€…ï¼ˆå»ºè­°ï¼‰
-- å…ˆåœ¨ Authentication > Users æ‰‹å‹•å»ºç«‹ä¸€å€‹ä½¿ç”¨è€…
-- Email: admin@test.com
-- Password: test123

-- ç„¶å¾ŒåŸ·è¡Œä»¥ä¸‹ SQL è¨­å®šç‚º admin
UPDATE public.profiles
SET
  role = 'admin',
  name = 'æ¸¬è©¦ç®¡ç†å“¡',
  is_active = true
WHERE email = 'admin@test.com';
```

æˆ–è€…å»ºç«‹ä¸€èˆ¬æ¸¬è©¦ä½¿ç”¨è€…ï¼š

```sql
-- å…ˆåœ¨ Authentication > Users æ‰‹å‹•å»ºç«‹ä½¿ç”¨è€…
-- Email: user@test.com
-- Password: test123

-- è¨­å®šä½¿ç”¨æœŸé™
UPDATE public.profiles
SET
  role = 'user',
  name = 'æ¸¬è©¦ä½¿ç”¨è€…',
  is_active = true,
  access_start_date = NOW(),
  access_end_date = NOW() + INTERVAL '30 days'
WHERE email = 'user@test.com';
```

### æ­¥é©Ÿ 2: æ¸¬è©¦ç™»å…¥æµç¨‹

1. **é–‹å•Ÿæ‡‰ç”¨ç¨‹å¼**
   ```bash
   npm run dev
   ```
   å‰å¾€ http://localhost:3000

2. **æ¸¬è©¦ Admin ç™»å…¥**
   - Email: admin@test.com
   - Password: test123
   - æ‡‰è©²æˆåŠŸç™»å…¥ä¸¦å°å‘ `/workspace`

3. **æ¸¬è©¦ä¸€èˆ¬ä½¿ç”¨è€…ç™»å…¥**
   - Email: user@test.com
   - Password: test123
   - æ‡‰è©²æˆåŠŸç™»å…¥ä¸¦å°å‘ `/workspace`

4. **æ¸¬è©¦ä½¿ç”¨æœŸé™**
   - ä¿®æ”¹ä½¿ç”¨è€…çš„ `access_end_date` ç‚ºéå»æ™‚é–“
   - å˜—è©¦ç™»å…¥æ‡‰è©²è¢«æ‹’çµ•
   - Admin ä¸å—æœŸé™é™åˆ¶

5. **æ¸¬è©¦å¿˜è¨˜å¯†ç¢¼**
   - é»æ“Šã€Œå¿˜è¨˜å¯†ç¢¼ã€é€£çµ
   - è¼¸å…¥ email
   - æª¢æŸ¥ email æ”¶ä»¶åŒ£ï¼ˆSupabase æœƒç™¼é€é‡è¨­é€£çµï¼‰

### æ­¥é©Ÿ 3: æ¸¬è©¦é‚€è«‹æµç¨‹ï¼ˆæœªä¾†ç®¡ç†å“¡åŠŸèƒ½ï¼‰

ç›®å‰é‚€è«‹é é¢å·²å»ºç«‹ï¼Œä½†å®Œæ•´çš„é‚€è«‹æµç¨‹éœ€è¦ï¼š
1. ç®¡ç†å“¡ä»‹é¢ï¼ˆå»ºç«‹ä½¿ç”¨è€…ï¼‰
2. é€é Supabase Admin API ç™¼é€é‚€è«‹ä¿¡
3. ä½¿ç”¨è€…é»æ“Šé‚€è«‹é€£çµè¨­å®šå¯†ç¢¼

---

## ğŸ¯ ä¸‹ä¸€æ­¥é–‹ç™¼å»ºè­°

### Phase 1: æ ¸å¿ƒåŠŸèƒ½é é¢
1. **å·¥ä½œå€é é¢** (`/workspace`)
   - æ–‡ç« è¼¸å…¥å€åŸŸ
   - AI æ”¹å¯«ç”¢å‡ºå€åŸŸ
   - é¸æ“‡æ¨¡æ¿åŠŸèƒ½

2. **æ¨¡æ¿ç®¡ç†é é¢** (`/templates`)
   - é¡¯ç¤ºä½¿ç”¨è€…æ¨¡æ¿åˆ—è¡¨
   - æ–°å¢/ç·¨è¼¯/åˆªé™¤æ¨¡æ¿
   - æ¨¡æ¿æ’åº

3. **æ­·å²è¨˜éŒ„é é¢** (`/history`)
   - é¡¯ç¤ºæ­·å²è¨˜éŒ„åˆ—è¡¨
   - æŸ¥çœ‹è©³ç´°å…§å®¹
   - åˆªé™¤è¨˜éŒ„

4. **è¨­å®šé é¢** (`/settings`)
   - ä¿®æ”¹å¯†ç¢¼
   - AI å¼•æ“è¨­å®š
   - å€‹äººè³‡æ–™

### Phase 2: ç®¡ç†å“¡åŠŸèƒ½
1. **ç®¡ç†å“¡å„€è¡¨æ¿** (`/admin`)
   - ç³»çµ±çµ±è¨ˆè³‡æ–™
   - æœ€è¿‘æ´»å‹•

2. **ä½¿ç”¨è€…ç®¡ç†** (`/admin/users`)
   - ä½¿ç”¨è€…åˆ—è¡¨
   - å»ºç«‹/ç·¨è¼¯/åœç”¨ä½¿ç”¨è€…
   - ç™¼é€é‚€è«‹ä¿¡
   - è¨­å®šä½¿ç”¨æœŸé™

3. **é è¨­æ¨¡æ¿ç®¡ç†** (`/admin/templates`)
   - ç®¡ç†é è¨­æ¨¡æ¿
   - å•Ÿç”¨/åœç”¨æ¨¡æ¿

### Phase 3: API é–‹ç™¼
1. **POST /api/generate**
   - æ¥æ”¶æ–‡ç« å’Œæ¨¡æ¿
   - å‘¼å« AI API
   - å›å‚³æ”¹å¯«çµæœ

2. **POST /api/templates/test**
   - æ¸¬è©¦æ¨¡æ¿åŠŸèƒ½

---

## ğŸ“ é‡è¦æé†’

### Supabase è¨­å®š
ç¢ºä¿ Supabase Email Settings å·²è¨­å®šï¼š
1. Authentication > Email Templates
   - Confirm signup
   - Reset password
   - Invite user

2. URL Configuration
   - Site URL: `http://localhost:3000`
   - Redirect URLs:
     - `http://localhost:3000/reset-password`
     - `http://localhost:3000/invite`

### ç’°å¢ƒè®Šæ•¸
ç¢ºèª `.env.local` è¨­å®šæ­£ç¢ºï¼š
```env
VITE_SUPABASE_URL=https://iffszgfbytwlcstkrnty.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
VITE_MAX_TEMPLATES=6
```

---

**å»ºç«‹æ—¥æœŸ**ï¼š2025-10-03
**ç‹€æ…‹**ï¼šèªè­‰ç³»çµ±å®Œæˆï¼Œæº–å‚™é–‹ç™¼æ ¸å¿ƒåŠŸèƒ½é é¢
